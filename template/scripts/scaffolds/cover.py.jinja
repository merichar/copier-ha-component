"""Cover platform for {{ component_name }}."""

from __future__ import annotations

from typing import Any

from homeassistant.components.cover import (
    CoverDeviceClass,
    CoverEntity,
    CoverEntityFeature,
)
from homeassistant.config_entries import ConfigEntry
from homeassistant.core import HomeAssistant
from homeassistant.helpers.entity_platform import AddEntitiesCallback
{% if has_entity_base -%}
from homeassistant.helpers.update_coordinator import CoordinatorEntity

from .const import DOMAIN
from .coordinator import {{ component_slug|replace('_', ' ')|title|replace(' ', '') }}DataUpdateCoordinator
from .entity import {{ component_slug|replace('_', ' ')|title|replace(' ', '') }}Entity
{%- else -%}
from homeassistant.helpers.update_coordinator import CoordinatorEntity

from .const import DOMAIN
from .coordinator import {{ component_slug|replace('_', ' ')|title|replace(' ', '') }}DataUpdateCoordinator
{%- endif %}


async def async_setup_entry(
    hass: HomeAssistant,
    entry: ConfigEntry,
    async_add_entities: AddEntitiesCallback,
) -> None:
    """Set up the cover platform."""
    coordinator = hass.data[DOMAIN][entry.entry_id]

    async_add_entities(
        [
            {{ component_slug|replace('_', ' ')|title|replace(' ', '') }}Cover(coordinator, entry),
        ]
    )


{% if has_entity_base -%}
class {{ component_slug|replace('_', ' ')|title|replace(' ', '') }}Cover(
    {{ component_slug|replace('_', ' ')|title|replace(' ', '') }}Entity, CoverEntity
):
    """{{ component_name }} Cover class."""

    _attr_device_class = CoverDeviceClass.BLIND
    _attr_supported_features = (
        CoverEntityFeature.OPEN
        | CoverEntityFeature.CLOSE
        | CoverEntityFeature.STOP
        | CoverEntityFeature.SET_POSITION
    )

    def __init__(
        self,
        coordinator: {{ component_slug|replace('_', ' ')|title|replace(' ', '') }}DataUpdateCoordinator,
        entry: ConfigEntry,
    ) -> None:
        """Initialize the cover."""
        super().__init__(coordinator, "cover")
        self._attr_name = f"{entry.title} Cover"
{%- else -%}
class {{ component_slug|replace('_', ' ')|title|replace(' ', '') }}Cover(
    CoordinatorEntity[{{ component_slug|replace('_', ' ')|title|replace(' ', '') }}DataUpdateCoordinator], CoverEntity
):
    """{{ component_name }} Cover class."""

    _attr_device_class = CoverDeviceClass.BLIND
    _attr_supported_features = (
        CoverEntityFeature.OPEN
        | CoverEntityFeature.CLOSE
        | CoverEntityFeature.STOP
        | CoverEntityFeature.SET_POSITION
    )

    def __init__(
        self,
        coordinator: {{ component_slug|replace('_', ' ')|title|replace(' ', '') }}DataUpdateCoordinator,
        entry: ConfigEntry,
    ) -> None:
        """Initialize the cover."""
        super().__init__(coordinator)
        self._attr_unique_id = f"{entry.entry_id}_cover"
        self._attr_name = f"{entry.title} Cover"
{%- endif %}

    @property
    def is_closed(self) -> bool | None:
        """Return if the cover is closed."""
        # TODO: Extract closed state from coordinator.data
        position = self.coordinator.data.get("position", 0)
        return position == 0

    @property
    def current_cover_position(self) -> int | None:
        """Return current position (0-100)."""
        # TODO: Extract position from coordinator.data
        return self.coordinator.data.get("position", 0)

    async def async_open_cover(self, **kwargs: Any) -> None:
        """Open the cover."""
        # TODO: Implement open logic
        # await self.coordinator.api.open_cover()
        await self.coordinator.async_request_refresh()

    async def async_close_cover(self, **kwargs: Any) -> None:
        """Close the cover."""
        # TODO: Implement close logic
        # await self.coordinator.api.close_cover()
        await self.coordinator.async_request_refresh()

    async def async_stop_cover(self, **kwargs: Any) -> None:
        """Stop the cover."""
        # TODO: Implement stop logic
        # await self.coordinator.api.stop_cover()
        await self.coordinator.async_request_refresh()

    async def async_set_cover_position(self, **kwargs: Any) -> None:
        """Move the cover to a specific position."""
        position = kwargs.get("position", 0)
        # TODO: Implement set_position logic
        # await self.coordinator.api.set_position(position)
        await self.coordinator.async_request_refresh()
