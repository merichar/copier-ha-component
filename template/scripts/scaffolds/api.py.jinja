"""API client for {{ component_name }}."""

from __future__ import annotations

import asyncio
import logging
from typing import Any

import aiohttp

_LOGGER = logging.getLogger(__name__)


class {{ component_slug|replace('_', ' ')|title|replace(' ', '') }}ApiClient:
    """API client for {{ component_name }}."""

    def __init__(
        self,
        host: str,
        session: aiohttp.ClientSession,
    ) -> None:
        """Initialize the API client."""
        self._host = host
        self._session = session

    async def async_get_data(self) -> dict[str, Any]:
        """Get data from the API.
        
        TODO: Customize this method for your API:
        - Update the endpoint URL
        - Add authentication if needed
        - Parse the response appropriately
        - Handle API-specific error codes
        """
        url = f"http://{self._host}/api/data"
        
        try:
            async with asyncio.timeout(10):
                response = await self._session.get(url)
                response.raise_for_status()
                return await response.json()
        except asyncio.TimeoutError as exception:
            _LOGGER.error("Timeout error fetching information: %s", exception)
            raise
        except aiohttp.ClientError as exception:
            _LOGGER.error("Error fetching information: %s", exception)
            raise

    async def async_set_state(self, state: bool) -> None:
        """Set device state.
        
        TODO: Implement your control logic:
        - Update the endpoint URL
        - Format the request body
        - Handle responses
        """
        url = f"http://{self._host}/api/state"
        data = {"state": "on" if state else "off"}
        
        try:
            async with asyncio.timeout(10):
                response = await self._session.post(url, json=data)
                response.raise_for_status()
        except asyncio.TimeoutError as exception:
            _LOGGER.error("Timeout error setting state: %s", exception)
            raise
        except aiohttp.ClientError as exception:
            _LOGGER.error("Error setting state: %s", exception)
            raise

    async def async_test_connection(self) -> bool:
        """Test if we can communicate with the device/service.
        
        TODO: Implement a lightweight check:
        - Ping endpoint
        - Status check
        - Authentication test
        """
        try:
            await self.async_get_data()
            return True
        except Exception:  # noqa: BLE001
            return False
