# Copier configuration
_templates_suffix: .jinja
_subdirectory: template

# Questions
component_name:
  type: str
  qmark: "> "
  help: |
    
    What is your component name?
    
    This is the human-readable name that will appear in the Home Assistant UI.
    Use title case and be descriptive but concise.
    
    Examples:
    * "Acme Thermostat" (for a specific device/brand)
    * "Solar Production" (for a data source)
    * "Room Occupancy" (for a sensor type)
    
    Avoid generic names like "Sensor" or "My Component"
    
  placeholder: "Acme Thermostat"
  validator: "{% if not component_name %}Component name is required{% endif %}"

component_slug:
  type: str
  qmark: "> "
  help: |
    
    Component slug (leave blank to auto-generate from name)
    
    This is the Python identifier used internally. It must be:
    * Lowercase
    * Use underscores (not hyphens or spaces)
    * Start with a letter
    * Be unique across all Home Assistant integrations
    
    Examples: acme_thermostat, solar_production, room_occupancy
    
    If you leave this blank, it will be auto-generated from your component name.
    
  default: "{{ component_name.lower().replace(' ', '_').replace('-', '_') }}"

repo_name:
  type: str
  qmark: "> "
  help: |
    
    Repository name (will be: ha-<slug>)
    
  default: "ha-{{ component_slug.replace('_', '-') }}"
  placeholder: "ha-{{ component_slug.replace('_', '-') }}"
  validator: "{% if not repo_name.startswith('ha-') %}Repository name must start with 'ha-'{% endif %}"

author_name:
  type: str
  qmark: "> "
  help: |
    
    Your name
    
    Used in:
    * LICENSE file (copyright holder)
    * Documentation and README
    
  placeholder: "Andrew Carnegie"
  validator: "{% if not author_name %}Your name is required{% endif %}"

author_email:
  type: str
  qmark: "> "
  help: |
    
    Your email
    
    Used in:
    * pyproject.toml maintainer info
    * Git commit configuration
    
  placeholder: "nachos@example.com"
  validator: "{% if not author_email %}Your email is required{% endif %}"

using_github:
  type: bool
  qmark: "> "
  help: |
    
    Are you using GitHub for hosting?
    
  default: true

vcs_name:
  type: str
  qmark: "> "
  help: |
    
    What version control hosting service are you using?
    
    Examples: GitLab, Gitea, Bitbucket
    
  default: "{% if using_github %}GitHub{% else %}GitLab{% endif %}"
  when: "{{ not using_github }}"

vcs_uri_prefix:
  type: str
  qmark: "> "
  help: |
    
    What is your VCS URI prefix?
    
    Include the trailing slash.
    
  default: "{% if using_github %}https://github.com/{% else %}https://gitlab.com/{% endif %}"
  when: "{{ not using_github }}"
  placeholder: "https://gitlab.com/"

git_username:
  type: str
  qmark: "> "
  help: |
    
    Git hosting username
    
    Used in:
    * Repository URLs in manifest.json
    * Documentation links
    * Codeowners file (@username)
    
  default: "{{ author_email.split('@')[0] }}"
  placeholder: "nachos"
  validator: "{% if not git_username %}Git hosting username is required{% endif %}"

include_config_flow:
  type: bool
  qmark: "> "
  help: |
    
    Include config flow for UI configuration?
    
    Config flows allow users to set up your integration through the Home Assistant UI
    instead of requiring YAML configuration. This is the modern approach and strongly
    recommended for new integrations.
    
    If you choose no, users will need to configure your component in configuration.yaml.
    
    Learn more: https://developers.home-assistant.io/docs/config_entries_config_flow_handler
    
  default: true

iot_class:
  type: str
  qmark: "> "
  help: |
    
    IoT class (how your component communicates with devices/services)
    
    This classification helps users understand your component's behavior:
    
    * local_polling: Regularly checks a device on your local network (e.g., every 30s)
    * local_push: Device on local network sends updates when state changes
    * cloud_polling: Regularly checks a cloud API for updates
    * cloud_push: Cloud service sends updates when state changes (webhooks, websockets)
    * calculated: Performs calculations only, no external communication
    * assumed_state: Cannot confirm device state, assumes commands succeed
    * decide_later: Choose this if you're not sure yet (you can update manifest.json later)
    
    Most integrations are either local_polling or cloud_polling.
    
    Learn more: https://developers.home-assistant.io/docs/core/entity/#properties
    
  default: decide_later
  choices:
    - local_polling
    - local_push
    - cloud_polling
    - cloud_push
    - calculated
    - assumed_state
    - decide_later

include_mit_license:
  type: bool
  qmark: "> "
  help: |
    
    Include MIT License?
    
    The MIT License is a permissive open-source license that allows others to use,
    modify, and distribute your code with minimal restrictions. It only requires:
    * Attribution (keeping your copyright notice)
    * Including the license text in distributions
    
    Most Home Assistant custom components use either MIT or Apache-2.0 licenses.
    MIT is simpler and more common for smaller projects.
    
    If you choose no, remember to add your own LICENSE file before publishing.
    
    Learn more: https://choosealicense.com/licenses/mit/
    
  default: true

# Conditional file exclusion
_exclude:
  - "{% if not include_config_flow %}custom_components/{{ component_slug }}/config_flow.py.jinja{% endif %}"
  - "{% if not include_config_flow %}custom_components/{{ component_slug }}/strings.json.jinja{% endif %}"

# Post-generation tasks
_tasks:
  - "git init -b"
  - "git add ."
  - 'git commit -m "feat: initial component from copier-ha-component template"'
  - "pre-commit install || echo 'Note: Run pre-commit install after installing dev dependencies'"

# Post-generation message
_message_after_copy: |
  
  Component {{ component_name }} created successfully!
  
  Next steps:
  {% if iot_class == 'decide_later' %}
    0. Update 'iot_class' in custom_components/{{ component_slug }}/manifest.json
       This is required for Home Assistant to accept your component.
       Choose from: local_polling, local_push, cloud_polling, cloud_push, calculated, assumed_state
  {% endif %}
  
    1. Create a new repository on {{ vcs_name }}
       Suggested name: {{ repo_name }}
  
    2. Push your code:
       git remote add origin {{ vcs_uri_prefix }}{{ git_username }}/{{ repo_name }}.git
       git push -u origin main
  
    3. Set up development environment:
       - Option A: Use devcontainer (VS Code or compatible IDE)
       - Option B: Manual setup with uv:
         uv venv
         source .venv/bin/activate  # or .venv/Scripts/activate on Windows
         uv pip install -e .[dev]
  
    4. Run tests:
       pytest
  {% if not include_mit_license %}
  
  Note: Don't forget to add a LICENSE file! Visit https://choosealicense.com/ for guidance.
  {% endif %}
